<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0070)http://www.marstu.mari.ru:8101/mmlab/home/prolog/LECTION14/program.htm -->
<HTML><HEAD><TITLE>Логическое и функциональное программирование. Лекция 14</TITLE>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META content="MSHTML 5.00.2920.0" name=GENERATOR></HEAD>
<BODY aLink=#0000ff bgColor=#c7d4ea link=green text=#000000>
<P><FONT face="Arial Cyr">
<H2 align=center><FONT color=#000080 face="Arial Cyr"><A name=#Lec14.3>Программа 
"Быки и Коровы"</FONT></H2>
<CENTER><IMG height=8 src="program.files/saqual.gif" width="90%"></CENTER>
<P><B>master mind (Code): -cleanup, guess (Code), check (Code), 
announce<BR>guess(Code):-Code=[X1,X2,X3,X4],selects(Code,[1,2,3,4,5,6,7,8,9,0]).
<P></B>/* Verify the proposed guess */
<P><B>check(Guess):-not inconsistent(Guess),ask(Guess).
<P>inconsistent(Guess):-query(OldGuess,Bulls,Cows), not 
bulls_and_cows_match(OldGuess,Guess,Bulls,Cows).
<P>bulls_and_cows_match(OldGuess,Guess,Bulls,Cows):-<BR>exact_matches(OldGuess,Guess,N1),<BR>Bulls 
=:= N1,<BR>common_members(OldGuess,Guess,N2),<BR>Cows =:= N2 - Bulls.
<P>exact_matches(X,Y,N):-size_of(A,same_place(A,X,Y),N). 
<P>common_members(X,Y,N):-size_of(A,(member(A,X),member(A,Y)),N).
<P>same_place(X,[X|Xs],[X|Ys]).<BR>same_place(A,[X|Xs],[Y|Ys]):-same_place(A,Xs,Ys).
<P></B>/* Asking a guess */
<P><B>ask(Guess):-repeat,write_ln(['How many bulls and cows in 
',Guess,'?']),<BR>read((Bulls,Cows)),<BR>sensible(Bulls,Cows), 
!,<BR>assert(query(Guess,Bulls,Cows)),<BR>Bulls=:=4. 
<P>sensible(Bulls,Cows):-integer(Bulls),integer(Cows),Bulls+Cows=4. 
<P></B>/* Bookkeeping */<B> 
<P>cleanup :- abolish(query,3). 
<P>announce :-<BR>size_of(X,query(X,A,B),N),<BR>write_ln(['Found the answer 
after ',N,' queries']).
<P>size_of(X,Goal,N) :-<BR>findall(X,Goal,Instances),length(Instances,N).
<P>selects([X|Xs],Ys) 
:-<BR>select(X,Ys,Ys1),selects(Xs,Ys1).<BR>selects([],Ys).<BR>select(X,[X|Xs],Xs).<BR>select(X,[Y|Ys],[Y|Zs]) 
:-<BR>select(X,Ys,Zs).
<P>length(Xs,N) :- length(Xs,0,N).<BR>length([X|Xs],Acc,N) :-<BR>Acc1 is Acc + 
1,<BR>length(Xs,Acc1,N).<BR>length([],N,N).
<P></B>Спрашивающая процедура <B>guess</B> действует как генератор, использует 
процедуру <B>selekt (Xs Ys)</B> для недетерминированного выбора списка <B>Хs</B> 
из элементов списка <B>Ys</B> Согласно правилам игры, <B>Хs</B> ограничивается 
четырьмя различными десятичными цифрами, в то время как список <B>Ys</B> 
содержит 10 десятичных цифр. Процедура <B>check (guess)</B> 
<P><!-- UL>
  <LI> <font face="Arial Cyr">Имена всех отношений и объектов с маленькой буквы. 
    </font>
  <LI> <font face="Arial Cyr">Сначала записывается имя отношения, затем в круглых скобках через запятую объекты.  </font>
  <LI> <font face="Arial Cyr">В конце ставится точка.  </font>
</UL -->
<CENTER></CENTER></A></FONT></BODY></HTML>
